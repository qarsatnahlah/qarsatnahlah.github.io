<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>تفاصيل المنتج - قرصة نحلة</title>
  <meta name="description" content="صفحة تفاصيل المنتج من قرصة نحلة" />
  <link rel="canonical" href="https://qarsatnahlah.github.io/product.html" />
  <meta property="og:locale" content="ar_AR" />
  <meta property="og:type" content="product" />
  <meta property="og:title" content="تفاصيل المنتج - قرصة نحلة" />
  <meta property="og:description" content="صفحة تفاصيل المنتج من قرصة نحلة" />
  <meta property="og:url" content="https://qarsatnahlah.github.io/product.html" />
  <meta property="og:image" content="https://qarsatnahlah.github.io/imgs/logo.jpeg" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="تفاصيل المنتج - قرصة نحلة" />
  <meta name="twitter:description" content="صفحة تفاصيل المنتج من قرصة نحلة" />
  <meta name="twitter:image" content="https://qarsatnahlah.github.io/imgs/logo.jpeg" />

  <script>
  // Dynamically set canonical/OG and inject Product JSON-LD based on ?id=
  (function(){
    const params = new URLSearchParams(location.search);
    const id = params.get('id');
    const base = 'https://qarsatnahlah.github.io/';
    const pageUrl = base + 'product.html' + (id ? ('?id=' + encodeURIComponent(id)) : '');

    // Update canonical
    const ensureLink = (rel)=>{ let el=document.querySelector(`link[rel="${rel}"]`); if(!el){ el=document.createElement('link'); el.setAttribute('rel', rel); document.head.appendChild(el);} return el; };
    ensureLink('canonical').setAttribute('href', pageUrl);

    // Update basic OG/Twitter
    const setMeta = (nameOrProp, content, isProp=true)=>{
      const sel = isProp ? `meta[property="${nameOrProp}"]` : `meta[name="${nameOrProp}"]`;
      let el = document.querySelector(sel);
      if(!el){ el = document.createElement('meta'); if(isProp){ el.setAttribute('property', nameOrProp); } else { el.setAttribute('name', nameOrProp); } document.head.appendChild(el); }
      el.setAttribute('content', content);
    };
    setMeta('og:url', pageUrl, true);

    if(!id) return; // no specific product id

    fetch('data/products.json', {cache:'no-store'}).then(r=>r.json()).then(data=>{
      const p = (data.products||[]).find(x=> String(x.id)===String(id));
      if(!p) return;
      const title = p.title || 'منتج';
      const desc = (p.description||'').trim() || 'منتج من قرصة نحلة';
      const img = (p.images && p.images[0]) || p.thumbnail || 'imgs/logo.jpeg';
      const absImg = img.startsWith('http') ? img : (base + img);
      const currency = (p.currency || data.currency || 'EGP');
      // pick default weight price if exists
      const ws = Array.isArray(p.weights)?p.weights:[];
      const pickDefaultWeight = (ws, prod)=>{
        if(!Array.isArray(ws) || ws.length===0) return null;
        if(prod && prod.defaultWeightId){ const byId = ws.find(w=> String(w.id)===String(prod.defaultWeightId)); if(byId) return byId; }
        const byFlag = ws.find(w=> w && w.default===true); if(byFlag) return byFlag;
        const inStock = ws.find(w=> w && w.inStock!==false); if(inStock) return inStock;
        return ws[0];
      };
      const v = pickDefaultWeight(ws, p);
      const price = v ? Number(v.price||0) : Number(p.price||0);
      const availability = (p.stockStatus||'in_stock')==='in_stock' ? 'https://schema.org/InStock' : 'https://schema.org/OutOfStock';

      document.title = title + ' - قرصة نحلة';
      setMeta('og:title', title + ' - قرصة نحلة', true);
      setMeta('og:description', desc, true);
      setMeta('og:image', absImg, true);
      setMeta('twitter:title', title + ' - قرصة نحلة', false);
      setMeta('twitter:description', desc, false);
      setMeta('twitter:image', absImg, false);

      const ld = {
        "@context": "https://schema.org",
        "@type": "Product",
        "name": title,
        "image": [absImg],
        "description": desc,
        "sku": p.sku || p.id,
        "brand": { "@type":"Brand", "name":"قرصة نحلة" },
        "offers": {
          "@type": "Offer",
          "url": pageUrl,
          "priceCurrency": currency,
          "price": price,
          "availability": availability
        }
      };
      const tag = document.createElement('script');
      tag.type = 'application/ld+json';
      tag.textContent = JSON.stringify(ld);
      document.head.appendChild(tag);
    }).catch(()=>{});
  })();
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css" />
  <link rel="stylesheet" href="css/all.min.css">
  <link rel="icon" type="image/x-icon" href="imgs/logo.ico">
</head>
<body>
  <!-- Header -->
  <header class="topbar">
    <nav class="container topbar__inner">
      <div class="brand nav-left" aria-label="الشعار">
        <a href="index.html"><img src="imgs/logo.jpeg" alt="" class="brand-logo" viewBox="0 0 64 64" width="44" height="44" aria-hidden="true"></a>
        <form id="navSearchForm" class="nav-search" action="index.html" role="search">
          <i class="fa-solid fa-magnifying-glass nav-search__icon" aria-hidden="true"></i>
          <label for="navSearchInput" class="visually-hidden">بحث</label>
          <input id="navSearchInput" name="q" class="nav-search__input" type="search" placeholder="ابحث عن منتج..." autocomplete="off" />
        </form>
      </div>
      <div class="nav-center">
        <ul class="breadcrumb">
          <li><a href="index.html">الرئيسية</a></li>
          <li><a href="honey.html">العسل</a></li>
          <li><a href="herbs.html">الأعشاب</a></li>
          <li><a href="oils.html">الزيوت</a></li>
          <li><a href="mixes.html">الخلطات</a></li>
          <li><a href="other-products.html">منتجات أخرى</a></li>
          <li><a href="contact.html">تواصل معنا</a></li>
        </ul>
      </div>
      <div class="nav-right">
        <button class="menu-toggle" aria-label="فتح القائمة" aria-controls="sideMenu" aria-expanded="false">
          <i class="fa-solid fa-bars"></i>
        </button>
        <button class="cart" aria-label="سلة المشتريات">
          <i class="fa-solid fa-cart-shopping"></i>
          <span class="cart__badge" aria-hidden="true">0</span>
        </button>
      </div>
    </nav>
  </header>

  <!-- Side menu -->
  <aside id="sideMenu" class="side-menu" aria-hidden="true" tabindex="-1">
    <div class="side-menu__panel" role="dialog" aria-label="القائمة">
      <div class="side-menu__header">
        <span class="side-menu__title">القائمة</span>
        <button class="side-menu__close" aria-label="إغلاق القائمة">
          <i class="fa-solid fa-xmark"></i>
        </button>
      </div>
      <ul class="side-menu__list">
        <li><a href="index.html">الرئيسية</a></li>
        <li><a href="honey.html">العسل</a></li>
        <li><a href="herbs.html">الأعشاب</a></li>
        <li><a href="oils.html">الزيوت</a></li>
        <li><a href="mixes.html">الخلطات</a></li>
        <li><a href="other-products.html">منتجات أخرى</a></li>
        <li><a href="contact.html">تواصل معنا</a></li>
      </ul>
    </div>
    <div class="side-menu__backdrop" aria-hidden="true"></div>
  </aside>

  <!-- Product Details -->
  <section id="productSection" class="section-pad" aria-labelledby="productTitle">
    <div class="container">
      <div id="productDetail" class="product-detail">
        <!-- يتم توليد المحتوى بواسطة js/product-details.js -->
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="site-footer" aria-labelledby="footerTitle">
    <div class="container footer__grid">
      <section class="footer__col" aria-label="نبذة">
        <h3 id="footerTitle" class="footer__title">قَرْصَةُ نَحْلَةٍ</h3>
        <p class="footer__text">متجرُكم الأول للمنتجات الطبيعية من العسل والأعشاب والزيوت، جودةٌ تثق بها.</p>
      </section>
      <nav class="footer__col" aria-label="روابط سريعة">
        <h4 class="footer__heading">روابط سريعة</h4>
        <ul class="footer__links">
          <li><a href="index.html">الرئيسية</a></li>
          <li><a href="honey.html">العسل</a></li>
          <li><a href="mixes.html">الخلطات</a></li>
          <li><a href="other-products.html">منتجات أخرى</a></li>
          <li><a href="contact.html">تواصل معنا</a></li>
        </ul>
      </nav>
      <nav class="footer__col" aria-label="الفئات">
        <h4 class="footer__heading">الفئات</h4>
        <ul class="footer__links">
          <li><a href="honey.html">العسل</a></li>
          <li><a href="herbs.html">الأعشاب</a></li>
          <li><a href="oils.html">الزيوت</a></li>
        </ul>
      </nav>
      <section class="footer__col" aria-label="تواصل معنا">
        <h4 class="footer__heading">تواصل معنا</h4>
        <ul class="footer__links footer__contact">
          <li>
            <a href="tel:+201018288736" aria-label="اتصال هاتفي">
              <i class="fa-solid fa-phone"></i>
              <span>+201018288736</span>
            </a>
          </li>
          <li>
            <a href="mailto:qarsatnahlah@gmail.com" aria-label="بريد إلكتروني">
              <i class="fa-solid fa-at"></i>
              <span>qarsatnahlah@gmail.com</span>
            </a>
          </li>
        </ul>
      </section>
      <section class="footer__col" aria-label="تابعنا">
        <h4 class="footer__heading">تابعنا</h4>
        <div class="footer__social">
          <a href="https://wa.me/201018288736" aria-label="واتساب"><i class="fa-brands fa-whatsapp"></i></a>
          <a href="#" aria-label="فيسبوك"><i class="fa-brands fa-facebook"></i></a>
          <a href="#" aria-label="فيسبوك ماسنجر"><i class="fa-brands fa-facebook-messenger"></i></a>
        </div>
      </section>
    </div>
    <hr class="footer__divider" aria-hidden="true">
    <div class="container footer__bottom">
      <p class="footer__copy">2024 قرصة نحلة جميع الحقوق محفوظة</p>
      <a href="https://ch-momahmoud.github.io/" class="footer__copy" target="_blank">تصميم ,انشاء  Ch.M.M </a>
    </div>
  </footer>

  <script src="js/script.js"></script>
  <script src="js/cart.js"></script>
  <script src="js/product-details.js"></script>
</body>
</html>
